<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cqjtu.wlw.dao.ClientDao"><!-- 表示该xml和哪个DAO接口对应 -->


    <!-- 配置使自定义的DAO接口生效的方法 -->
    <!-- 配置addStudentInfo方法 -->
    <insert id="addClientInfo" parameterType="ClientInfo">
        <!-- insert方法，标签id和接口方法名相同，方法的形参的类型 -->
        insert into client_info(client_id,client_name,client_sex,client_phone,client_addr,client_photo,lock_id)
        values(#{clientId},#{clientName},#{clientSex},#{clientPhone},#{clientAddr},#{clientPhoto},#{lockId})
        <!-- 表示接口的addStudentInfo方法要执行的sql语句，#{}表示从方法的形参里取值 -->
    </insert>

    <!-- 配置deleteStudentInfo方法 -->
    <delete id="deleteClientInfo" parameterType="ClientInfo">
		delete from
		client_info where client_id = #{clientId}
	</delete>

    <!-- 配置updateStudentInfo方法 -->
    <update id="updateClientInfo" parameterType="ClientInfo">
		update client_info
		set client_name = #{clientName},client_sex = #{clientSex},client_phone = #{clientPhone},
		client_photo=#{clientPhoto},client_addr = #{clientAddr},lock_id= #{lock_id}
		where client_id = #{clientId}
	</update>


    <resultMap type="ClientInfo" id="cmap">
        <!-- type:对应的实体类 -->
        <id column="client_id" property="clientId"/>
        <!-- column:对应是数据库中的名字,property属性对应的是实体类中的属性名 -->
        <result column="client_name" property="clientName" />
        <result column="client_sex" property="clientSex" />
        <result column="client_addr" property="clientAddr" />
        <association property="lockInfo" javaType="lockInfo">
            <!-- property="school"定义在是bean中TeacherInfo的外键 -->
            <!-- javaType="schoolInfo"映射外键关联的表，与bean中名称相同 -->
            <id column="lock_id" property="lockId"/><!-- 主键 -->
            <result column="lock_type" property="lockType"/><!-- 非主键 -->
        </association>

    </resultMap>

    <select id="getClientInfoById" parameterType="ClientInfo" resultMap="cmap">
		select * from client_info where client_id=#{clientId}
	</select>

    <!-- <select id="getStudentInfos" resultType="List" resultMap="stumap">
        select * from student_info; </select> -->

    <select id="getClientInfos" parameterType="ClientInfo"
            resultType="List" resultMap="cmap">
        select * from client_info<!-- 只用姓名和电话查询 -->
        <where>
            <if test="clientName != null and clientName !=''">
                and client_name like #{clientName}
            </if>
            <if test="clientPhone != null and clientPhone != ''">
                and client_phone like #{clientPhone}
            </if>
        </where>
    </select>

</mapper>
